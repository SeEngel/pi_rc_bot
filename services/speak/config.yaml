## Speak service configuration
##
## This service mirrors the PiCar-X example `example/14.voice_promt_car.py`:
##   from picarx.tts import Pico2Wave
##   tts = Pico2Wave(); tts.set_lang('de-DE'); tts.say("...")
##
## You can pick either:
##   - backend: robot_hat  -> uses `robot_hat.tts` (or `picarx.tts` re-export)
##   - backend: system     -> uses system binaries (`pico2wave`, `espeak`)

tts:
  # backend: robot_hat | system
  # Note: backend is only relevant for engine=pico2wave/espeak.
  backend: robot_hat

  # engine: openai | piper 
  # - openai uses OpenAI TTS (requires OPENAI_API_KEY)
  # - piper uses local Piper voices (auto-downloads models)
  #engine: o
  engine: piper

  # Language (used for Pico2Wave). Examples:
  #   en-US, en-GB, de-DE, es-ES, fr-FR, it-IT
  language: de-DE

  # Print spoken text to the console (helpful for debugging / demos)
  print_text: true

  # If true, do NOT play audio â€” only prints text.
  # Useful if you're running on a machine without audio devices.
  dry_run: false

  # Optional: set OS output volume (0..100).
  # - Implemented for Linux only (Raspberry Pi OS). On other OSes you'll get a warning.
  # - Best-effort: tries pactl (PulseAudio/PipeWire), wpctl (PipeWire), then amixer (ALSA).
  # - If your audio is quiet but gets louder when you raise the system volume, enable this.
  system_volume_percent: 100

  # Only used when backend=system and engine=pico2wave:
  # player_cmd: aplay | paplay
  player_cmd: aplay

  # Only used when backend=system and engine=pico2wave:
  # Apply extra gain (in dB) to the generated WAV before playing it.
  # Requires `sox` (preferred) or `ffmpeg`.
  # Beware: large values can clip/distort.
  pico2wave_gain_db: 0.0

  # Only used when backend=system and engine=pico2wave and player_cmd=paplay:
  # 0..65536 (65536 = 100%)
  paplay_volume: 65536

  # Only used when engine=espeak (backend can be robot_hat or system):
  # (system backend uses these directly; robot_hat backend may ignore them)
  espeak:
    # voice examples:
    #   de, en, en-us, en-sc, en-uk, fr, es, it
    # List voices on your machine:
    #   espeak --voices
    voice: de

  # System backend espeak tuning (if you use engine=espeak)
  espeak_speed: 160      # 80..450
  espeak_amplitude: 200  # 0..200

  # OpenAI TTS (engine=openai)
  openai:
    # API key is read from the environment only:
    #   export OPENAI_API_KEY=...
    model: gpt-4o-mini-tts
    voice: alloy
    # Optional: style instructions
    instructions: ""
    # Stream audio while downloading (low latency)
    # Note: some robot_hat/OpenAI streaming setups produce artifacts on long texts.
    # If you hear crackling/noise, set stream=false and enable chunking.
    stream: false
    # Playback gain (1.0 = unchanged). Higher values can clip/distort ("crackling").
    gain: 1.0

    # Long-text handling: split long input into smaller chunks and speak sequentially.
    # This avoids some backend issues with very long inputs.
    chunking: true
    # Max characters per request/chunk.
    max_chars: 600

  # Piper (engine=piper)
  piper:
    # Voice model. Examples:
    #   en_US-amy-low
    #   de_DE-thorsten-high
    model: de_DE-thorsten-high
    # Piper streaming is fastest, but gain control is only applied when we play the WAV ourselves.
    stream: false
    # Playback gain (1.0 = unchanged). Try 1.5..3.0.
    gain: 1.5
